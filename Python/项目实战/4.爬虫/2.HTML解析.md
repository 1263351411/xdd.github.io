# HTML解析

HTML的内容返回给浏览器，浏览器就会解析它，并对它渲染。  

HTML超文本表示语言，设计的初衷就是为了超越普通文本，让文本表现力更强。  
XML扩展标记语言，不是为了替代HTML，而是觉得HTML的设计中包含了过多的格式，承担了一部分数据之外的任务，所以才设计了XML只用来描述数据。  

HTML和XML都有结构，使用标记形成树型的嵌套结构。DOM(Document Object Model)来解析这种嵌套树型结构，浏览器往往都提供了对DOM操作的API，可以用面向对象的方式来操作DOM。  

## XPath

* [http://www.w3school.com.cn/xpath/index.asp](http://www.w3school.com.cn/xpath/index.asp)中文教程
* XPath是一门在XML文档中查找信息的语言。XPath可用来在XML文档中对元素和属性进行遍历。

* 测试工具：XMLQuire win7+需要.net框架4.0-4.5。
* 测试XML、XPath

    1. 测试文档  

        ````xml
        <?xml version="1.0" encoding="utf-8"?>
        <bookstore>
        <book id="bk101">
            <author>Gambardella, Matthew</author>
            <title>XML Developer's Guide</title>
            <genre>Computer</genre>
            <price>44.95</price>
            <publish_date>2000-10-01</publish_date>
            <description>An in-depth look at creating applications 
            with XML.</description>
        </book>
        <book id="bk102" class="bookinfo even">
            <author>Ralls, Kim</author>
            <title>Midnight Rain</title>
            <genre>Fantasy</genre>
            <price>5.95</price>
            <publish_date>2000-12-16</publish_date>
            <description>A former architect battles corporate zombies, 
            an evil sorceress, and her own childhood to become queen 
            of the world.</description>
        </book>
        <book id="bk103">
            <author>Corets, Eva</author>
            <title>Maeve Ascendant</title>
            <genre>Fantasy</genre>
            <price>5.95</price>
            <publish_date>2000-11-17</publish_date>
            <description>After the collapse of a nanotechnology 
            society in England, the young survivors lay the 
            foundation for a new society.</description>
        </book>
        <book id="bk104">
            <author>Corets, Eva</author>
            <title>Oberon's Legacy</title>
            <genre>Fantasy</genre>
            <price>5.95</price>
            <publish_date>2001-03-10</publish_date>
            <description>In post-apocalypse England, the mysterious 
            agent known only as Oberon helps to create a new life 
            for the inhabitants of London. Sequel to Maeve 
            Ascendant.</description>
        </book>
        </bookstore>
        ````

    2. 测试工具:XMLQuire win7+需要.NET框架4.0-4.5。  
    ![xpath_001](../../../img/python/xpath_001.png)

### 节点

* 在XPath中，有七种类型的节点：**元素、属性、文本、命名空间、处理指令、注释以及文档(根)节点。**
    1. `/`根节点
    2. `<bookstore>`元素节点
    3. `<author>Corets,Eva</author>`元素节点。
    4. `id="bk104"`是属性节点，id是元素节点book的属性
* 节点之间的嵌套形成**父子(parent,children)关系**。
* 具有统一个父结点的不同节点是**兄弟(sibling)关系**。  

* **节点选择**

|操作符或表达式|含义|
|:------------|:------|
|`/`|从根节点开始找|
|`//`|从当前节点开始的任意层找|
|`.`|当前节点|
|`..`|当前结点的父节点|
|`@`|选择属性|
|`节点名`|选取所有这个节点名的节点|
|`*`|匹配任意元素节点|
|`@*`|匹配任意属性节点|
|`node()`|匹配任意类型的节点|
|`text()`|匹配text类型节点|

* **谓语(Predicates)**

1. 谓语用来查找某个特定的节点或者包含某个指定的值的节点。
2. **谓语被嵌在方括号中**。
3. 谓语就是查询的条件。
4. 即在路径选择时，在中括号内指定查询条件。  

* **XPath轴(Axes)**

1. 轴的意思是相对于当前结点的节点集

|轴名称|结果|
|:--------|:----------|
|ancestor|选取当前结点的所有先辈(父、祖父等)|
|ancestor-or-self|选取当前节点的所有先辈(父、祖父等)以及当前节点本身|
|attribute|选取当前节点的所有属性。@id等价于attribute::id|
|child|选取当前节点的所有子元素，title等价于child:title|
|descendant|选取当前节点的所有后代元素(子、孙等)|
|descendant-or-self|选取当前节点的所有后代运算(子、孙等)以及当前节点本身|
|following|选取文档中当前节点的结束标签之后的所有结点|
|namespace|选取当前节点的所有命名空间节点|
|parent|选取当前节点的父节点|
|preceding|选取当前节点的父节点|
|preceding-sibling|选取当前节点之前的所有同级节点|
|self|选取当前节点。等驾驭self::node()|

* **步Step**

1. 步的语法`轴名称：节点测试[谓语]`

|例子|结果|
|child::book|选取所有属于当前节点的只元素的book节点|
|attribute::lang|选取当前节点的lang属性|
|child::*|选取当前节点的所有只元素|
|attribute::*|选取当前节点的所有属性|
|child::text()|选取当前节点的所有文本子节点|
|child::node()|选取当前节点的所有子节点|
|descendant::book|选取当前节点的所有book后代|
|ancestor:book|选择当前节点的所有book先辈|
|ancestor-or-self::book|选取当前节点的所有book先辈以及当前节点(如果此节点是book节点)
|child::*/child::price|选取当前节点的所有price孙节点|













