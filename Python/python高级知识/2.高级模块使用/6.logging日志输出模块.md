# logging日志输出模块

@[toc]

## 日志级别

|日志级别Level|对应数值|
|:----|:----------|
CRITICAL|50
ERROR|40
WARRNING|30,默认级别
INFO|20
DEBUG|10
NOTSET|0

````python
import logging

print("logging.CRITICAL = ",logging.CRITICAL)
print("logging.ERROR = ",logging.ERROR)
print("logging.WARNING = ",logging.WARNING)
print("logging.INFO = ",logging.INFO)
print("logging.DEBUG = ",logging.DEBUG)
print("logging.NOTSET = ",logging.NOTSET)
````

![logging_001.jpg](../../../img/python/logging_001.jpg)  

日志级别指的是产生日志的事件的严重程度。  
设置一个级别后，严重程度低于设置的日志消息将被忽略。  
对应的打印方法有：debug()、info()、warning()、error()、和critical()方法  

## 常用的格式字符串

* 常用的格式字符串通常定义在Format里面。
|属性名称|格式|描述|
|:-------|:--------|:-----------|
|日志消息内容|%(message)s|使用对应级别打印时传入的message变量值。<br/>可以使用Formatter.format()设置设置打印格式。
|asctime|%(asctime)s|创建LogRecord时的可读时间。默认情况下，它的格式为'2003-07-08 16:49:45,896'（逗号后面的数字是毫秒部分的时间）
|函数名|%(funcName)s|日志调用所在函数的函数名
|日志级别名称|%(levelname)s|消息的级别名称：<br/>"DEBUG","INFO","WARNING","ERROR","CRITICAL"
|日志级别数值|%(levelno)s|消息的级别数字，对应DEBUG,INFO,WARNING,ERROR,CRITICAL
|行号|%(lineno)d|日志调用所在的源码行号
|模块|%(module)d|模块(filename名字部分)
|进程ID|%(process)d|进程ID
|线程ID|%(thread)d|线程ID
|进程名称|%(processName)s|进程名称
|线程名称|%(threadName)s|线程名称
|logger名称|%(name)s|使用的logger对应名称

注意：funcName,threadName,processName都是小驼峰。

## 举例

* 使用默认级别输出日志
    1. #初始化时，如果没指定level，那么level的默认级别为WARNING
    2. 低于默认级别(也就是小于默认级别值的)消息输出将不会被输出。

````python
import logging

FORMAT = "%(asctime)-15s Thread info: %(thread)d %(threadName)s %(message)s"
logging.basicConfig(format=FORMAT,level=logging.WARNING) #初始化时，如果没指定level，那么level的默认级别为WARNING

logging.info("打印测试 {}".format(1)) #info不显示
logging.warning("打印测试 {}".format(2)) #warning是默认级别
````

![logging_002.jpg](../../../img/python/logging_002.jpg)  

* 构建消息

````python
import logging

FORMAT = "%(asctime)-15s Thread info: %(thread)d %(threadName)s %(message)s"
logging.basicConfig(format=FORMAT,level=logging.INFO) #初始化时，如果没指定level，那么level的默认级别为WARNING

logging.info("我是 {}".format(20)) #单一字符串输出
logging.info("我是 %d %s",20,"岁") #c风格输出
````

![logging_003.jpg](../../../img/python/logging_003.jpg)  

* 如果需要使用自定义格式，可用在format字符串中指定，在打印字符串时传入extra字典对应即可

````python
import logging

FORMAT = "%(asctime)-15s Thread info: %(thread)d %(threadName)s %(message)s %(gdy)s %(xdd)s"
logging.basicConfig(format=FORMAT,level=logging.INFO) #初始化时，如果没指定level，那么level的默认级别为WARNING

logging.info("我是 {}".format(20),extra={"xdd":"我是xdd变量","gdy":"我是gdy变量"}) #单一字符串输出
logging.info("我是 %d %s",20,"岁",extra={"xdd":"我是xdd变量","gdy":"我是gdy变量"}) #c风格输出
````

![logging_004.jpg](../../../img/python/logging_004.jpg)  

* 如果输出日期需要了指定格式。可以在basicConfig中使用datefmt参数为日期指定格式

````python
import logging

logging.basicConfig(format="%(asctime)s %(message)s",datefmt="%Y%m%d %H:%M:%S")
logging.warning("你好")
````

![logging_005.jpg](../../../img/python/logging_005.jpg)  

* 如果需要将信息输出到文件可以定义filename选择，在basicConfig中

````python
import logging

logging.basicConfig(format="%(asctime)s %(message)s",datefmt="%Y%m%d %H:%M:%S",filename="D://test.log")

for i in range(5):
    logging.warning("你好 {}".format(i))
````

## Logger类

在logging模块中，顶层代码中有
![logging_006.jpg](../../../img/python/logging_006.jpg)  















